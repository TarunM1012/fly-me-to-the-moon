<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåô Moon Slingshot - Physics Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        /* Stars background */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #fff, transparent),
                radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
                radial-gradient(2px 2px at 160px 30px, #ddd, transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: twinkle 4s ease-in-out infinite alternate;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .game-container {
            position: relative;
            z-index: 10;
            text-align: center;
        }

        .game-title {
            color: #fff;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(255, 255, 255, 0.5); }
            to { text-shadow: 0 0 30px rgba(255, 255, 255, 0.8), 0 0 40px rgba(255, 255, 255, 0.3); }
        }

        #gameCanvas {
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            cursor: crosshair;
        }

        .ui-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #fff;
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 20;
        }

        .score {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .instructions {
            color: #fff;
            font-size: 1rem;
            margin: 1rem 0;
            text-align: center;
            max-width: 600px;
            line-height: 1.5;
        }

        .message {
            color: #fff;
            font-size: 1.3rem;
            margin: 1rem 0;
            min-height: 2rem;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .retry-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            border: none;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            margin: 0.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
            font-weight: bold;
        }

        .retry-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }

        .fact {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1rem;
            margin: 1rem 0;
            color: #fff;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .upgrades {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .upgrade-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .upgrade-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .upgrade-btn.active {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            border-color: #4CAF50;
        }

        @media (max-width: 768px) {
            .game-title {
                font-size: 2rem;
            }
            
            .ui-panel {
                position: relative;
                top: auto;
                left: auto;
                margin: 1rem auto;
                max-width: 90%;
            }
            
            #gameCanvas {
                max-width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="game-title">üåô Moon Slingshot</h1>
        
        <div class="ui-panel">
            <div class="score">Score: <span id="score">0</span></div>
            <div>Attempts: <span id="attempts">0</span></div>
            <div style="margin-top: 10px;">
                <label style="color: #fff; margin-right: 10px;">Difficulty:</label>
                <select id="difficultySelect" onchange="changeDifficulty()" style="background: rgba(255,255,255,0.2); color: #fff; border: 1px solid rgba(255,255,255,0.3); padding: 2px 5px; border-radius: 3px;">
                    <option value="easy">Easy</option>
                    <option value="medium">Medium</option>
                    <option value="hard">Hard</option>
                </select>
            </div>
        </div>
        
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div class="instructions">
            <strong>How to play:</strong> Click and drag from Earth to aim your rocket! 
            Release to launch. Hit the moon to score points! üåô
        </div>
        
        <div class="message" id="message">Drag from Earth to aim your rocket!</div>
        
        <div class="upgrades">
            <button class="upgrade-btn" id="ionEngine" onclick="toggleUpgrade('ionEngine')">
                ‚ö° Ion Engine
            </button>
            <button class="upgrade-btn" id="wormhole" onclick="toggleUpgrade('wormhole')">
                üåå Wormhole Warp
            </button>
        </div>
        
        <div class="fact" id="fact" style="display: none;"></div>
        
        <button class="retry-btn" id="retryBtn" onclick="resetGame()" style="display: none;">
            üîÑ Try Again
        </button>
    </div>

    <script>
        // Game constants
        const GRAVITY = 0.3;
        const EARTH_RADIUS = 40;
        const ROCKET_SIZE = 8;
        const MOON_RADIUS = 25;
        const TRAIL_LENGTH = 20;
        const ASTEROID_RADIUS = 8;

        // Game state
        let gameState = {
            score: 0,
            attempts: 0,
            isDragging: false,
            isLaunched: false,
            gameWon: false,
            difficulty: 'easy', // 'easy', 'medium', 'hard'
            upgrades: {
                ionEngine: false,
                wormhole: false
            }
        };

        // Physics objects
        let earth = { x: 400, y: 300 }; // Centered on screen
        let rocket = { 
            x: 400, 
            y: 260, // Just above Earth
            vx: 0, 
            vy: 0, 
            trail: [],
            isLaunched: false,
            orbitRadius: 0,
            orbitAngle: 0,
            isOrbiting: false
        };
        let moon = { 
            x: 400, 
            y: 200, 
            orbitCenter: { x: 400, y: 300 },
            orbitRadius: 250,
            orbitSpeed: 0.005, // Much slower
            orbitAngle: 0
        };
        let asteroids = [];

        // Mouse/touch state
        let mouse = { x: 0, y: 0, isDown: false };

        // Fun space facts
        const spaceFacts = [
            "üß† Did you know the moon's gravity is only 1/6th of Earth's?",
            "üåü The moon is 238,855 miles away from Earth!",
            "üöÄ Projectile motion follows parabolic trajectories!",
            "üåç The moon orbits Earth at 2,288 mph!",
            "üí´ Isaac Newton discovered the laws of motion!",
            "üåô The moon has no atmosphere - perfect for physics!",
            "‚ö° Gravity affects all objects equally (Galileo's discovery)!",
            "üî≠ The moon's surface is covered in craters!",
            "üåå Orbital mechanics are used for space travel!",
            "üõ∏ Escape velocity from Earth is 25,020 mph!"
        ];

        // Canvas setup
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Initialize game
        function initGame() {
            updateScore();
            resetRocket();
            randomizeMoon();
            generateAsteroids();
            gameLoop();
        }

        // Main game loop
        function gameLoop() {
            update();
            render();
            requestAnimationFrame(gameLoop);
        }

        // Update game state
        function update() {
            // Update moon movement
            updateMoon();
            
            // Update asteroids
            updateAsteroids();
            
            // Update rocket physics
            if (rocket.isLaunched) {
                updateRocket();
            }
            
            // Check collisions
            checkCollisions();
        }

        // Update moon movement (orbital around Earth)
        function updateMoon() {
            // Orbital movement around Earth
            moon.orbitAngle += moon.orbitSpeed;
            moon.x = moon.orbitCenter.x + Math.cos(moon.orbitAngle) * moon.orbitRadius;
            moon.y = moon.orbitCenter.y + Math.sin(moon.orbitAngle) * moon.orbitRadius;
        }

        // Update asteroids
        function updateAsteroids() {
            for (let asteroid of asteroids) {
                // Move asteroids in different patterns
                asteroid.x += asteroid.vx;
                asteroid.y += asteroid.vy;
                
                // Wrap around screen
                if (asteroid.x < -50) asteroid.x = canvas.width + 50;
                if (asteroid.x > canvas.width + 50) asteroid.x = -50;
                if (asteroid.y < -50) asteroid.y = canvas.height + 50;
                if (asteroid.y > canvas.height + 50) asteroid.y = -50;
            }
        }

        // Generate asteroids based on difficulty
        function generateAsteroids() {
            asteroids = [];
            
            let asteroidCount = 0;
            switch (gameState.difficulty) {
                case 'easy':
                    asteroidCount = 0;
                    break;
                case 'medium':
                    asteroidCount = 5;
                    break;
                case 'hard':
                    asteroidCount = 15;
                    break;
            }
            
            for (let i = 0; i < asteroidCount; i++) {
                asteroids.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    vx: (Math.random() - 0.5) * 2,
                    vy: (Math.random() - 0.5) * 2
                });
            }
        }

        // Update rocket physics with orbital mechanics
        function updateRocket() {
            if (rocket.isOrbiting) {
                // Orbital motion
                rocket.orbitAngle += 0.02;
                rocket.x = earth.x + Math.cos(rocket.orbitAngle) * rocket.orbitRadius;
                rocket.y = earth.y + Math.sin(rocket.orbitAngle) * rocket.orbitRadius;
            } else {
                // Apply gravity towards Earth
                const dx = earth.x - rocket.x;
                const dy = earth.y - rocket.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > 10) {
                    // Apply gravitational force
                    const force = 0.1 / (distance * distance);
                    rocket.vx += (dx / distance) * force;
                    rocket.vy += (dy / distance) * force;
                }
                
                // Update position
                rocket.x += rocket.vx;
                rocket.y += rocket.vy;
                
                // Check for orbital capture
                const distanceFromEarth = Math.sqrt((rocket.x - earth.x) ** 2 + (rocket.y - earth.y) ** 2);
                const velocity = Math.sqrt(rocket.vx ** 2 + rocket.vy ** 2);
                
                if (distanceFromEarth > 50 && distanceFromEarth < 200 && velocity < 3) {
                    rocket.isOrbiting = true;
                    rocket.orbitRadius = distanceFromEarth;
                    rocket.orbitAngle = Math.atan2(rocket.y - earth.y, rocket.x - earth.x);
                }
            }
            
            // Add to trail
            rocket.trail.push({ x: rocket.x, y: rocket.y });
            if (rocket.trail.length > TRAIL_LENGTH) {
                rocket.trail.shift();
            }
            
            // Check if rocket is off screen
            if (rocket.y > canvas.height + 50 || rocket.x < -50 || rocket.x > canvas.width + 50) {
                if (!gameState.gameWon) {
                    setTimeout(() => {
                        showMessage("Missed! Try again!", "#ff6b6b");
                        document.getElementById('retryBtn').style.display = 'inline-block';
                    }, 1000);
                }
            }
        }

        // Check for collisions
        function checkCollisions() {
            if (!rocket.isLaunched) return;
            
            // Check moon collision
            const dx = rocket.x - moon.x;
            const dy = rocket.y - moon.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < MOON_RADIUS + ROCKET_SIZE) {
                gameWon();
            }
            
            // Check asteroid collisions
            for (let asteroid of asteroids) {
                const dx = rocket.x - asteroid.x;
                const dy = rocket.y - asteroid.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < ASTEROID_RADIUS + ROCKET_SIZE) {
                    gameLost();
                    return;
                }
            }
        }

        // Handle game win
        function gameWon() {
            gameState.gameWon = true;
            gameState.score += 100;
            gameState.attempts++;
            updateScore();
            
            showMessage("üéâ SUCCESS! You hit the moon!", "#00ff00");
            showRandomFact();
            
            setTimeout(() => {
                resetGame();
            }, 3000);
        }

        // Handle game loss (asteroid collision)
        function gameLost() {
            gameState.attempts++;
            updateScore();
            
            showMessage("üí• CRASH! Asteroid collision!", "#ff6b6b");
            
            setTimeout(() => {
                resetGame();
            }, 2000);
        }

        // Render everything
        function render() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw stars background
            drawStars();
            
            // Draw Earth
            drawEarth();
            
            // Draw asteroids
            drawAsteroids();
            
            // Draw moon
            drawMoon();
            
            // Draw rocket
            drawRocket();
            
            // Draw trajectory preview
            if (gameState.isDragging && !rocket.isLaunched) {
                drawTrajectory();
            }
        }

        // Draw stars
        function drawStars() {
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            for (let i = 0; i < 50; i++) {
                const x = (i * 37) % canvas.width;
                const y = (i * 73) % canvas.height;
                const size = Math.sin(Date.now() * 0.001 + i) * 0.5 + 1;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Draw Earth
        function drawEarth() {
            // Earth glow
            const gradient = ctx.createRadialGradient(earth.x, earth.y, 0, earth.x, earth.y, EARTH_RADIUS + 15);
            gradient.addColorStop(0, 'rgba(0, 150, 255, 0.8)');
            gradient.addColorStop(1, 'rgba(0, 150, 255, 0)');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(earth.x, earth.y, EARTH_RADIUS + 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Earth
            ctx.fillStyle = '#0066cc';
            ctx.beginPath();
            ctx.arc(earth.x, earth.y, EARTH_RADIUS, 0, Math.PI * 2);
            ctx.fill();
            
            // Earth continents
            ctx.fillStyle = '#00aa44';
            ctx.beginPath();
            ctx.arc(earth.x - 10, earth.y - 5, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(earth.x + 8, earth.y + 3, 6, 0, Math.PI * 2);
            ctx.fill();
            
            // Earth border
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(earth.x, earth.y, EARTH_RADIUS, 0, Math.PI * 2);
            ctx.stroke();
        }

        // Draw asteroids
        function drawAsteroids() {
            ctx.fillStyle = '#8B4513';
            for (let asteroid of asteroids) {
                ctx.beginPath();
                ctx.arc(asteroid.x, asteroid.y, ASTEROID_RADIUS, 0, Math.PI * 2);
                ctx.fill();
                
                // Asteroid details
                ctx.fillStyle = '#654321';
                ctx.beginPath();
                ctx.arc(asteroid.x - 2, asteroid.y - 2, 2, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(asteroid.x + 3, asteroid.y + 1, 1.5, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#8B4513';
            }
        }

        // Draw moon
        function drawMoon() {
            // Moon glow
            const gradient = ctx.createRadialGradient(moon.x, moon.y, 0, moon.x, moon.y, MOON_RADIUS + 15);
            gradient.addColorStop(0, 'rgba(255, 255, 255, 0.6)');
            gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(moon.x, moon.y, MOON_RADIUS + 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Moon
            ctx.fillStyle = '#f0f0f0';
            ctx.beginPath();
            ctx.arc(moon.x, moon.y, MOON_RADIUS, 0, Math.PI * 2);
            ctx.fill();
            
            // Moon craters
            ctx.fillStyle = '#d0d0d0';
            ctx.beginPath();
            ctx.arc(moon.x - 8, moon.y - 8, 3, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(moon.x + 10, moon.y + 5, 2, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(moon.x - 5, moon.y + 12, 2.5, 0, Math.PI * 2);
            ctx.fill();
        }

        // Draw rocket
        function drawRocket() {
            // Draw trail
            if (rocket.trail.length > 1) {
                ctx.strokeStyle = gameState.upgrades.ionEngine ? '#00ffff' : '#ffa500';
                ctx.lineWidth = 3;
                ctx.lineCap = 'round';
                ctx.beginPath();
                ctx.moveTo(rocket.trail[0].x, rocket.trail[0].y);
                
                for (let i = 1; i < rocket.trail.length; i++) {
                    const alpha = i / rocket.trail.length;
                    ctx.strokeStyle = gameState.upgrades.ionEngine ? 
                        `rgba(0, 255, 255, ${alpha})` : 
                        `rgba(255, 165, 0, ${alpha})`;
                    ctx.lineTo(rocket.trail[i].x, rocket.trail[i].y);
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.moveTo(rocket.trail[i].x, rocket.trail[i].y);
                }
            }
            
            // Draw rocket
            ctx.save();
            ctx.translate(rocket.x, rocket.y);
            
            // Calculate rotation based on velocity
            const angle = Math.atan2(rocket.vy, rocket.vx);
            ctx.rotate(angle);
            
            // Rocket body
            ctx.fillStyle = '#ff4444';
            ctx.fillRect(-ROCKET_SIZE, -ROCKET_SIZE, ROCKET_SIZE * 2, ROCKET_SIZE * 2);
            
            // Rocket tip
            ctx.fillStyle = '#ff6666';
            ctx.beginPath();
            ctx.moveTo(ROCKET_SIZE, 0);
            ctx.lineTo(ROCKET_SIZE + 8, -4);
            ctx.lineTo(ROCKET_SIZE + 8, 4);
            ctx.closePath();
            ctx.fill();
            
            // Engine flame
            if (rocket.isLaunched) {
                ctx.fillStyle = gameState.upgrades.ionEngine ? '#00ffff' : '#ffa500';
                ctx.beginPath();
                ctx.moveTo(-ROCKET_SIZE, 0);
                ctx.lineTo(-ROCKET_SIZE - 12, -6);
                ctx.lineTo(-ROCKET_SIZE - 8, 0);
                ctx.lineTo(-ROCKET_SIZE - 12, 6);
                ctx.closePath();
                ctx.fill();
            }
            
            ctx.restore();
        }

        // Draw trajectory preview
        function drawTrajectory() {
            const dx = mouse.x - earth.x;
            const dy = mouse.y - earth.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const power = Math.min(distance / 3, 15);
            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            
            // Draw trajectory points with orbital mechanics
            let x = earth.x;
            let y = earth.y;
            let vx = -dx / distance * power;
            let vy = -dy / distance * power;
            
            ctx.beginPath();
            ctx.moveTo(x, y);
            
            for (let i = 0; i < 100; i++) {
                // Apply gravitational force towards Earth
                const dxToEarth = earth.x - x;
                const dyToEarth = earth.y - y;
                const distanceToEarth = Math.sqrt(dxToEarth * dxToEarth + dyToEarth * dyToEarth);
                
                if (distanceToEarth > 10) {
                    const force = 0.1 / (distanceToEarth * distanceToEarth);
                    vx += (dxToEarth / distanceToEarth) * force;
                    vy += (dyToEarth / distanceToEarth) * force;
                }
                
                x += vx;
                y += vy;
                
                ctx.lineTo(x, y);
                
                if (y > canvas.height || x < 0 || x > canvas.width) break;
            }
            
            ctx.stroke();
            ctx.setLineDash([]);
        }

        // Mouse event handlers
        function handleMouseDown(e) {
            const rect = canvas.getBoundingClientRect();
            mouse.x = e.clientX - rect.left;
            mouse.y = e.clientY - rect.top;
            
            // Check if clicking on Earth
            const dx = mouse.x - earth.x;
            const dy = mouse.y - earth.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < EARTH_RADIUS && !rocket.isLaunched) {
                gameState.isDragging = true;
                mouse.isDown = true;
            }
        }

        function handleMouseMove(e) {
            const rect = canvas.getBoundingClientRect();
            mouse.x = e.clientX - rect.left;
            mouse.y = e.clientY - rect.top;
        }

        function handleMouseUp(e) {
            if (gameState.isDragging && !rocket.isLaunched) {
                launchRocket();
            }
            gameState.isDragging = false;
            mouse.isDown = false;
        }

        // Launch rocket
        function launchRocket() {
            const dx = mouse.x - earth.x;
            const dy = mouse.y - earth.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const power = Math.min(distance / 3, 15);
            
            rocket.vx = -dx / distance * power;
            rocket.vy = -dy / distance * power;
            rocket.isLaunched = true;
            gameState.isLaunched = true;
            gameState.attempts++;
            
            showMessage("üöÄ Rocket launched!", "#ffff00");
            updateScore();
        }

        // Reset rocket
        function resetRocket() {
            rocket.x = earth.x;
            rocket.y = earth.y - 40; // Just above Earth
            rocket.vx = 0;
            rocket.vy = 0;
            rocket.isLaunched = false;
            rocket.isOrbiting = false;
            rocket.trail = [];
            gameState.isLaunched = false;
            gameState.gameWon = false;
            gameState.isDragging = false;
            
            document.getElementById('retryBtn').style.display = 'none';
            showMessage("Drag from Earth to aim your rocket!", "#fff");
        }

        // Reset game
        function resetGame() {
            resetRocket();
            randomizeMoon();
        }

        // Randomize moon position
        function randomizeMoon() {
            // Moon orbits around Earth center
            moon.orbitCenter.x = earth.x;
            moon.orbitCenter.y = earth.y;
            moon.orbitRadius = 250;
            moon.orbitSpeed = 0.005; // Very slow
            moon.orbitAngle = Math.random() * Math.PI * 2;
        }

        // Show message
        function showMessage(text, color = "#fff") {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.style.color = color;
        }

        // Show random fact
        function showRandomFact() {
            const fact = document.getElementById('fact');
            const randomFact = spaceFacts[Math.floor(Math.random() * spaceFacts.length)];
            fact.textContent = randomFact;
            fact.style.display = 'block';
            
            setTimeout(() => {
                fact.style.display = 'none';
            }, 5000);
        }

        // Update score display
        function updateScore() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('attempts').textContent = gameState.attempts;
        }

        // Change difficulty
        function changeDifficulty() {
            const difficultySelect = document.getElementById('difficultySelect');
            gameState.difficulty = difficultySelect.value;
            generateAsteroids();
            resetGame();
        }

        // Toggle upgrades
        function toggleUpgrade(upgrade) {
            const btn = document.getElementById(upgrade);
            gameState.upgrades[upgrade] = !gameState.upgrades[upgrade];
            
            if (gameState.upgrades[upgrade]) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        }

        // Event listeners
        canvas.addEventListener('mousedown', handleMouseDown);
        canvas.addEventListener('mousemove', handleMouseMove);
        canvas.addEventListener('mouseup', handleMouseUp);

        // Touch events for mobile
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            handleMouseDown({ clientX: touch.clientX, clientY: touch.clientY });
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            handleMouseMove({ clientX: touch.clientX, clientY: touch.clientY });
        });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            handleMouseUp();
        });

        // Initialize game
        window.addEventListener('load', initGame);
    </script>
</body>
</html> 